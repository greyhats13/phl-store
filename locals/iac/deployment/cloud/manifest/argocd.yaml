# Ref: https://github.com/argoproj/argo-helm/tree/main/charts/argo-cd
global:
  domain: "${feature}.${dns_name}"
  params:
    server.insecure: ${extra_vars.server_insecure}
server:
  ingress:
    enabled: ${extra_vars.ingress_enabled}
    ingressClassName: ${extra_vars.ingress_class_name}
    annotations:
      external-dns.alpha.kubernetes.io/hostname: "${feature}.${dns_name}"
      external-dns.alpha.kubernetes.io/ttl: "300"
      kubernetes.io/tls-acme: "true"
      cert-manager.io/cluster-issuer: "letsencrypt-phl"
  hosts:
    - host: ${feature}.${dns_name}
      paths:
        - path: /
          pathType: ImplementationSpecific
  tls:
    - secretName: argocd-tls
      hosts:
        - ${feature}.${dns_name}

# ref: https://github.com/argoproj-labs/argocd-vault-plugin/blob/main/manifests/cmp-sidecar/argocd-repo-server.yaml
repoServer:
  serviceAccount:
    name: ${feature}-repo-server
    # Not strictly necessary, but required for passing AVP configuration from a secret and for using Kubernetes auth to Hashicorp Vault
    automountServiceAccountToken: true
